install.packages('tidyverse')
install.packages('tidycensus')
install.packages('sf')
install.packages('tigris')
install.packages('kableExtra')
install.packages('ggforce') #built above ggplot 2
install.packages('osmdata')
install.packages("flexdashboard") #make dashboards
#install.packages("scales") #ggplot 2 scales and legend grammar
install.packages("shiny")
library(tidyverse)
library(tidycensus)
library(sf)
library(kableExtra)
library(osmdata)
library(ggforce)
library(tigris)
library(flexdashboard)
#library(scales)
library(shiny)
options(scipen=999)
options(tigris_class = "sf")
source("https://raw.githubusercontent.com/urbanSpatial/Public-Policy-Analytics-Landing/master/functions.r")
#Load API KEY
census_api_key("3aedcfd189958d66a813a29a4b33580e78657644", overwrite = TRUE)
#Set CRS
crs='EPSG:3857'
#Read in Raw CSV data
CBP_Apprehensions2124 <- read.csv("E:/Github/CubanMigration/CBP_Apprehensions_Encounters2124.csv")
#Read in Raw CSV data
CBP_Apprehensions2124 <- read.csv("E:/Github/CubanMigration/data/CBP_Apprehensions_Encounters2124.csv")
#Read in Raw CSV data
CBP_Apprehensions2124 <- read.csv("E:/Github/CubanMigration/data/CBP_Apprehensions_Encounters2124.csv")
UN_2020_cubansabroad <- read.csv("E:/Github/CubanMigration/data/UN_2020_Cuban_Migrants_Abroad.csv")
UN_netmigration19502020 <- read.csv("E:/Github/CubanMigration/data/UN_NetMigration_19502020.csv")
library(ggplot2)
#this chunk is to create line graphs of the nation/mexican/cuban over time (bar)
ggplot(CPB_Apprehensions2124, aes(x = row.names(CPB_Apprehensions2124), y = ., fill = names(CPB_Apphensions2124[-1]))) +
geom_bar(stat = "identity") +  # Use "identity" to represent raw data values
labs(title = "CPB Apprehensions (2024)",  # Set a title
x = "Year",                        # Label for x-axis
y = "Number of Apprehensions")       # Label for y-axis
#Read in Raw CSV data
CBP_Apprehensions2124 <- read.csv("E:/Github/CubanMigration/data/CBP_Apprehensions_Encounters2124.csv")
UN_2020_cubansabroad <- read.csv("E:/Github/CubanMigration/data/UN_2020_Cuban_Migrants_Abroad.csv")
UN_netmigration19502020 <- read.csv("E:/Github/CubanMigration/data/UN_NetMigration_19502020.csv")
#this chunk is to create line graphs of the nation/mexican/cuban over time (bar)
ggplot(CBP_Apprehensions2124, aes(x = row.names(CBP_Apprehensions2124), y = ., fill = names(CBP_Apphensions2124[-1]))) +
geom_bar(stat = "identity") +  # Use "identity" to represent raw data values
labs(title = "CBP Apprehensions (2024)",  # Set a title
x = "Year",                        # Label for x-axis
y = "Number of Apprehensions")       # Label for y-axis
View(CBP_Apprehensions2124)
View(CBP_Apprehensions2124)
#this chunk is to create line graphs of the nation/mexican/cuban over time (bar)
ggplot(CBP_Apprehensions2124, aes(x = year, fill = names(CBP_Apphensions2124[-1]))) +
geom_bar(stat = "identity") +  # Use "identity" to represent raw data values
labs(title = "CBP Apprehensions (2024)",  # Set a title
x = "Year",                        # Label for x-axis
y = "Number of Apprehensions")       # Label for y-axis
#this chunk is to create line graphs of the nation/mexican/cuban over time (bar)
ggplot(CBP_Apprehensions2124, aes(x = year, fill = names(CBP_Apprhensions2124[-1]))) +
geom_bar(stat = "identity") +  # Use "identity" to represent raw data values
labs(title = "CBP Apprehensions (2024)",  # Set a title
x = "Year",                        # Label for x-axis
y = "Number of Apprehensions")       # Label for y-axis
#this chunk is to create line graphs of the nation/mexican/cuban over time (bar)
ggplot(CBP_Apprehensions2124, aes(x = year, fill = names(CBP_Apprehensions2124[-1]))) +
geom_bar(stat = "identity") +  # Use "identity" to represent raw data values
labs(title = "CBP Apprehensions (2024)",  # Set a title
x = "Year",                        # Label for x-axis
y = "Number of Apprehensions")       # Label for y-axis
CBPAPP_2124 <- melt(CBP_Apprehensions2124, id.vars = "Year")  # Melts data into a format suitable for ggplot2
install.packages('reshape2')
library(reshape2)
CBPAPP_2124 <- melt(CBP_Apprehensions2124, id.vars = "Year")  # Melts data into a format suitable for ggplot2
CBPAPP_2124 <- melt(CBP_Apprehensions2124, id.vars = "year")  # Melts data into a format suitable for ggplot2
View(CBP_Apprehensions2124)
View(CBPAPP_2124)
View(CBPAPP_2124)
#this chunk is to create line graphs of the nation/mexican/cuban over time (bar)
CBPAPP_2124 <- melt(CBP_Apprehensions2124, id.vars = "year")  # Melts data into a format suitable for ggplot2
ggplot(CBPAPP_2124, aes(x = year, y = value, color = variable)) +  # Color by variable (country)
geom_line() +                                               # Create lines for each country
labs(title = "U.S. Customs and Border Patrol: Apprehensions",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "Number of Apprehensions")                             # Label for y-axis)
View(CBP_Apprehensions2124)
CBP_Apprehensions2124 <- read.csv("E:/Github/CubanMigration/data/CBP_Apprehensions_Encounters2124.csv")
CBPAPP_2124 <- melt(CBP_Apprehensions2124, id.vars = "year")  # Melts data into a format suitable for ggplot2
ggplot(CBPAPP_2124, aes(x = year, y = value, color = variable)) +  # Color by variable (country)
geom_line() +                                               # Create lines for each country
labs(title = "U.S. Customs and Border Patrol: Apprehensions",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "Number of Apprehensions")                             # Label for y-axis)
#this chunk is to create line graphs of the nation/mexican/cuban over time (bar)
CBPAPP_2124 <- melt(CBP_Apprehensions2124, id.vars = "year")  # Melts data into a format suitable for ggplot2
ggplot(CBPAPP_2124, aes(x = year, y = value, color = variable)) +  # Color by variable (country)
geom_line() +                                               # Create lines for each country
labs(title = "U.S. Customs and Border Patrol: Apprehensions",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "Number of Apprehensions")+
scale_x_discrete(breaks = seq(min(CBPAPP_2124$year), max(CBPAPP_2124$year), by = 1))# Label for y-axis)
CBPAPP_2124$year <- as.factor(CBPAPP_2124$year)
#this chunk is to create line graphs of the nation/mexican/cuban over time (bar)
CBPAPP_2124 <- melt(CBP_Apprehensions2124, id.vars = "year")  # Melts data into a format suitable for ggplot2
CBPAPP_2124$year <- as.factor(CBPAPP_2124$year)
ggplot(CBPAPP_2124, aes(x = year, y = value, color = variable)) +  # Color by variable (country)
geom_line() +                                               # Create lines for each country
labs(title = "U.S. Customs and Border Patrol: Apprehensions",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "Number of Apprehensions")
scale_x_discrete(breaks = seq(min(CBPAPP_2124$year), max(CBPAPP_2124$year), by = 1))# Label for y-axis)
#this chunk is to create line graphs of the nation/mexican/cuban over time (bar)
CBPAPP_2124 <- melt(CBP_Apprehensions2124, id.vars = "year")  # Melts data into a format suitable for ggplot2
CBPAPP_2124$year <- as.factor(CBPAPP_2124$year)
ggplot(CBPAPP_2124, aes(x = year, y = value, color = variable)) +  # Color by variable (country)
geom_line() +                                               # Create lines for each country
labs(title = "U.S. Customs and Border Patrol: Apprehensions",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "Number of Apprehensions")
View(CBP_Apprehensions2124)
#this chunk is to create line graphs of the nation/mexican/cuban over time (bar)
CBPAPP_2124 <- melt(CBP_Apprehensions2124, id.vars = "year")  # Melts data into a format suitable for ggplot2
ggplot(CBPAPP_2124, aes(x = year, y = value, color = variable)) +  # Color by variable (country)
geom_line() +                                               # Create lines for each country
labs(title = "U.S. Customs and Border Patrol: Apprehensions",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "Number of Apprehensions")
#this chunk is to create line graphs of the nation/mexican/cuban over time (bar)
CBPAPP_2124 <- melt(CBP_Apprehensions2124, id.vars = "year")  # Melts data into a format suitable for ggplot2
ggplot(CBPAPP_2124, aes(x = year, y = value, color = variable)) +  # Color by variable (country)
geom_line() +                                               # Create lines for each country
labs(title = "U.S. Customs and Border Patrol: Apprehensions",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "Number of Apprehensions")+
scale_x_discrete(breaks = unique(CBPAPP_2124$year))
#this chunk is to create line graphs of the nation/mexican/cuban over time (bar)
CBPAPP_2124 <- melt(CBP_Apprehensions2124, id.vars = "year")  # Melts data into a format suitable for ggplot2
ggplot(CBPAPP_2124, aes(x = year, y = value, color = variable)) +  # Color by variable (country)
geom_line() +                                               # Create lines for each country
labs(title = "U.S. Customs and Border Patrol: Apprehensions",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "Number of Apprehensions")+
scale_x_discrete(breaks = unique(CBPAPP_2124$year), labels = unique(CBPAPP_2124$year))
View(UN_netmigration19502020)
#this chunk is to create line graphs of the nation/mexican/cuban over time (bar)
CBPAPP_2124 <- melt(CBP_Apprehensions2124, id.vars = "year")  # Melts data into a format suitable for ggplot2
ggplot(CBPAPP_2124, aes(x = year, y = value, color = variable)) +  # Color by variable (country)
geom_line() +                                               # Create lines for each country
labs(title = "U.S. Customs and Border Patrol: Apprehensions",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "Number of Apprehensions")+
scale_x_discrete(breaks = unique(CBPAPP_2124$year), labels = unique(CBPAPP_2124$year))+
scale_color_manual(values = veocuba_cp)
veocuba_cp <- c("#ca5733","#68a6d5", "#3b914e", "#fbc61d")
#this chunk is to create line graphs of the nation/mexican/cuban over time (bar)
CBPAPP_2124 <- melt(CBP_Apprehensions2124, id.vars = "year")  # Melts data into a format suitable for ggplot2
ggplot(CBPAPP_2124, aes(x = year, y = value, color = variable)) +  # Color by variable (country)
geom_line() +                                               # Create lines for each country
labs(title = "U.S. Customs and Border Patrol: Apprehensions",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "Number of Apprehensions")+
scale_x_discrete(breaks = unique(CBPAPP_2124$year), labels = unique(CBPAPP_2124$year))+
scale_color_manual(values = veocuba_cp)
#this chunk will create the line graph for 1950-2020 migration
ggplot(UN_netmigration19502020, aes(x = year, y = Net_Migration_Cuba, color=Net_Migration_Cuba)) +
geom_line() +
labs(title = "UN Net Migration: Cuba",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "NET MIGRATION")+
#this chunk will create the line graph for 1950-2020 migration
ggplot(UN_netmigration19502020, aes(x = year, y = Net_Migration_Cuba, color=Net_Migration_Cuba)) +
geom_line() +
labs(title = "UN Net Migration: Cuba",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "NET MIGRATION")
View(UN_netmigration19502020)
#this chunk will create the line graph for 1950-2020 migration
ggplot(UN_netmigration19502020, aes(x = Year, y = Net_Migration_Cuba, color=Net_Migration_Cuba)) +
geom_line() +
labs(title = "UN Net Migration: Cuba",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "NET MIGRATION")
#this chunk will create the line graph for 1950-2020 migration
ggplot(UN_netmigration19502020, aes(x = Year, y = Net_Migration_Cuba)) +
geom_line() +
labs(title = "UN Net Migration: Cuba",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "NET MIGRATION")
#this chunk will create the line graph for 1950-2020 migration
ggplot(UN_netmigration19502020, aes(x = Year, color=Net_Migration_Cuba)) +
geom_line() +
labs(title = "UN Net Migration: Cuba",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "NET MIGRATION")
#this chunk will create the line graph for 1950-2020 migration
ggplot(UN_netmigration19502020, aes(x = Year, color=Net_Migration_Cuba)) +
geom_bar() +
labs(title = "UN Net Migration: Cuba",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "NET MIGRATION")
#this chunk will create the line graph for 1950-2020 migration
ggplot(UN_netmigration19502020, aes(x = Year, y= Net_Migration_Cuba, color= Net_Migration_Cuba)) +
geom_bar() +
labs(title = "UN Net Migration: Cuba",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "NET MIGRATION")
#this chunk will create the line graph for 1950-2020 migration
ggplot(UN_netmigration19502020, aes(x = Year, y= Net_Migration_Cuba) +
geom_bar() +
labs(title = "UN Net Migration: Cuba",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "NET MIGRATION")
#this chunk will create the line graph for 1950-2020 migration
ggplot(UN_netmigration19502020, aes(x = Year, y= Net_Migration_Cuba)) +
geom_bar() +
labs(title = "UN Net Migration: Cuba",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "NET MIGRATION")
#this chunk will create the line graph for 1950-2020 migration
ggplot(UN_netmigration19502020, aes(x = Year, y= Net_Migration_Cuba)) +
geom_line() +
labs(title = "UN Net Migration: Cuba",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "NET MIGRATION")
UN_netmigration19502020$Net_Migration_Cuba <- int(UN_netmigration19502020$Net_Migration_Cuba)
UN_netmigration19502020$Net_Migration_Cuba <- as.numeric(UN_netmigration19502020$Net_Migration_Cuba)
#this chunk will create the line graph for 1950-2020 migration
UN_netmigration19502020$Net_Migration_Cuba <- as.numeric(UN_netmigration19502020$Net_Migration_Cuba)
ggplot(UN_netmigration19502020, aes(x = Year, y= Net_Migration_Cuba)) +
geom_line() +
labs(title = "UN Net Migration: Cuba",                 # Set a title
x = "Year",                                          # Label for x-axis
y = "NET MIGRATION")
#Read in Raw CSV data
CBP_Apprehensions2123 <- read.csv("E:/Github/CubanMigration/data/CBP_Apprehensions_Encounters2124.csv")
UN_2020_cubansabroad <- read.csv("E:/Github/CubanMigration/data/UN_2020_Cuban_Migrants_Abroad.csv")
UN_netmigration19502020 <- read.csv("E:/Github/CubanMigration/data/UN_NetMigration_19502020.csv")
#For plotting make the data wide
CBPAPP_2123 <- melt(CBP_Apprehensions2124, id.vars = "year")
View(CBPAPP_2123)
#for CBP Apprehensions
totals_CBP2123 <- CBPAPP_2123 %>%
group_by(variable)%>%
summarize(totals_2123=sum(value))%>%
kbl(caption= "Total Apprehensions/Encounters 2021-2023", col.names = "Nation", "Total")%>%
kable_classic_2(full_width = F, html_font = "Constantia")%>%
kable_styling(bootstrap_options = c("striped","hover"))
#for CBP Apprehensions
totals_CBP2123 <- CBPAPP_2123 %>%
group_by(variable)%>%
summarize(totals_2123=sum(value))%>%
kbl(caption= "Total Apprehensions/Encounters 2021-2023", col.names = "Total")%>%
kable_classic_2(full_width = F, html_font = "Constantia")%>%
kable_styling(bootstrap_options = c("striped","hover"))
totals_CBP2123 <- CBPAPP_2123 %>%
group_by(variable)%>%
summarize(totals_2123=sum(value))
View(totals_CBP2123)
#for CBP Apprehensions
totals_CBP2123 <- CBPAPP_2123 %>%
group_by(variable)%>%
summarize(totals_2123=sum(value))
totals_CBP2123 <- totals_CBP2123%>%
kbl(caption= "Total Apprehensions/Encounters 2021-2023", col.names = "Total")%>%
kable_classic_2(full_width = F, html_font = "Constantia")%>%
kable_styling(bootstrap_options = c("striped","hover"))
#for CBP Apprehensions
totals_CBP2123 <- CBPAPP_2123 %>%
group_by(variable)%>%
summarize(totals_2123=sum(value))
totals_CBP2123 <- totals_CBP2123%>%
kbl(caption= "Total Apprehensions/Encounters 2021-2023")%>%
kable_classic_2(full_width = F, html_font = "Constantia")%>%
kable_styling(bootstrap_options = c("striped","hover"))
#for CBP Apprehensions
totals_CBP2123 <- CBPAPP_2123 %>%
group_by(variable)%>%
summarize(totals_2123=sum(value))
kbl(caption= "Total Apprehensions/Encounters 2021-2023")%>%
kable_classic_2(full_width = F, html_font = "Constantia")%>%
kable_styling(bootstrap_options = c("striped","hover"))
#for CBP Apprehensions
totals_CBP2123 <- CBPAPP_2123 %>%
group_by(variable)%>%
summarize(totals_2123=sum(value))
totals_CBP2123%>%
kbl(caption= "Total Apprehensions/Encounters 2021-2023")%>%
kable_classic_2(full_width = F, html_font = "Constantia")%>%
kable_styling(bootstrap_options = c("striped","hover"))
#for CBP Apprehensions
totals_CBP2123 <- CBPAPP_2123 %>%
group_by(variable)%>%
summarize(totals_2123=sum(value))%>%
mutate(Percent_Total = total_2123/7924245)
#for CBP Apprehensions
totals_CBP2123 <- CBPAPP_2123 %>%
group_by(variable)%>%
summarize(total_2123=sum(value))%>%
mutate(Percent_Total = total_2123/7924245)
totals_CBP2123%>%
kbl(caption= "Total Apprehensions/Encounters 2021-2023")%>%
kable_classic_2(full_width = F, html_font = "Constantia")%>%
kable_styling(bootstrap_options = c("striped","hover"))
#for CBP Apprehensions
totals_CBP2123 <- CBPAPP_2123 %>%
group_by(variable)%>%
summarize(total_2123=sum(value))%>%
mutate(Percent_Total = round(total_2123/7924245,2)
totals_CBP2123%>%
#for CBP Apprehensions
totals_CBP2123 <- CBPAPP_2123 %>%
group_by(variable)%>%
summarize(total_2123=sum(value))%>%
mutate(Percent_Total = round(total_2123/7924245,2))
totals_CBP2123%>%
kbl(caption= "Total Apprehensions/Encounters 2021-2023")%>%
kable_classic_2(full_width = F, html_font = "Constantia")%>%
kable_styling(bootstrap_options = c("striped","hover"))
View(UN_2020_cubansabroad)
#Read in Raw CSV data
CBP_Apprehensions2123 <- read.csv("E:/Github/CubanMigration/data/CBP_Apprehensions_Encounters2124.csv")
UN_2020_cubansabroad <- read.csv("E:/Github/CubanMigration/data/UN_2020_Cuban_Migrants_Abroad.csv")
UN_netmigration19502020 <- read.csv("E:/Github/CubanMigration/data/UN_NetMigration_19502020.csv")
#For plotting make the data wide
CBPAPP_2123 <- melt(CBP_Apprehensions2124, id.vars = "year")
